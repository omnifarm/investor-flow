<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="resources/sheet.css">
<div id='embed_1087974296' class='waffle-embedded-object-overlay'
     style='width: 100%; height: 100%; display: block;'>
    <canvas id="overlay-canvas" style="position: absolute; top: 0; left: 0; pointer-events: none;"></canvas>
</div>
<script>
    function posObj(sheet, id, row, col, x, y) {
        var rtl = false;
        var sheetElement = document.getElementById(sheet);
        if (!sheetElement) {
            sheetElement = document.getElementById(sheet + '-grid-container');
        }
        if (sheetElement) {
            rtl = sheetElement.getAttribute('dir') == 'rtl';
        }
        var r = document.getElementById(sheet + 'R' + row);
        var c = document.getElementById(sheet + 'C' + col);
        if (r && c) {
            var objElement = document.getElementById(id);
            var s = objElement.style;
            var t = y;
            while (r && r != sheetElement) {
                t += r.offsetTop;
                r = r.offsetParent;
            }
            var offsetX = x;
            while (c && c != sheetElement) {
                offsetX += c.offsetLeft;
                c = c.offsetParent;
            }
            if (rtl) {
                offsetX -= objElement.offsetWidth;
            }
            s.left = offsetX + 'px';
            s.top = t + 'px';
            s.display = 'block';
            s.border = '1px solid #000000';
        }
    }

    function posObjs() {
        posObj('406006156', 'embed_1087974296', 0, 0, 0, 0);
    }

    posObjs();</script>
<script src="resources/3755735930-ChartsCombinedJ2clBootstrap_bootstrap_core.js"></script>
<script>var ritzspreadsheetconstants = {
    "localeName": "de_DE",
    "timeZoneConstants": {
        "GMT": {
            "names_ext": {"STD_GENERIC_LOCATION": "GMT", "STD_LONG_NAME_GMT": "GMT"},
            "std_offset": 0,
            "names": ["GMT", "Mittlere Greenwich-Zeit"],
            "id": "GMT",
            "transitions": []
        },
        "Atlantic/Reykjavik": {
            "names_ext": {"STD_GENERIC_LOCATION": "Island (Ortszeit)", "STD_LONG_NAME_GMT": "GMT"},
            "std_offset": 0,
            "names": ["GMT", "Mittlere Greenwich-Zeit"],
            "id": "Atlantic/Reykjavik",
            "transitions": []
        }
    },
    "numberFormatSymbols": {
        "DECIMAL_SEP": ",",
        "PERMILL": "‰",
        "MINUS_SIGN": "-",
        "PERCENT_PATTERN": "#,##0 %",
        "INFINITY": "∞",
        "DEF_CURRENCY_CODE": "EUR",
        "PLUS_SIGN": "+",
        "CURRENCY_PATTERN": "#,##0.00 ¤",
        "DECIMAL_PATTERN": "#,##0.###",
        "SCIENTIFIC_PATTERN": "#E0",
        "PERCENT": "%",
        "EXP_SYMBOL": "E",
        "GROUP_SEP": ".",
        "NAN": "NaN",
        "ZERO_DIGIT": "0"
    },
    "allowTerminalDateSeparator": true,
    "amPmEnglishAccepted": false,
    "currencyPrefix": false,
    "currencyTag": "\\ [$€-1]",
    "datePostsAreSuffix": true,
    "dateTimeWithoutYearPattern": "dd.MM HH:mm",
    "dateWithoutYearPattern": "dd.MM",
    "dayPost": "",
    "decimalSeparator": ",",
    "defaultDatePattern": "dd.MM.yyyy",
    "defaultDateTimePattern": "dd.MM.yyyy HH:mm:ss",
    "defaultTimePattern": "HH:mm:ss",
    "defaultUiLanguage": "de",
    "exponentSeparator": "E",
    "extraDateSeparator": "",
    "firstDayOfWeek": 1,
    "additionalFonts": [],
    "additionalFormats": [{"1": 5, "2": "dd.MM.yy", "3": 1}, {"1": 5, "2": "yyyy-MM-dd", "3": 1}, {
        "1": 5,
        "2": "dd.MM",
        "3": 1
    }, {"1": 5, "2": "d-MMM-yyyy", "3": 1}, {"1": 5, "2": "d. MMMM", "3": 1}, {"1": 6, "2": "HH:mm", "3": 1}, {
        "1": 7,
        "2": "dd.MM HH:mm",
        "3": 1
    }],
    "amPmStrings": ["AM", "PM"],
    "amString": "AM",
    "monthsFull": ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    "monthsShort": ["Jan.", "Feb.", "March", "Apr.", "May", "June", "July", "Aug.", "Sept.", "Oct.", "Nov.", "Dec."],
    "pmString": "PM",
    "timePrefix": "",
    "timeSeparator": ":",
    "weekdaysFull": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
    "weekdaysShort": ["Su.", "Mo.", "Tu.", "We.", "Th.", "Fr.", "Sa."],
    "groupingSeparator": ".",
    "hourPost": "",
    "minimalDaysInFirstWeek": 4,
    "minusSign": "-",
    "minutePost": "",
    "monthPost": "",
    "negativeParens": false,
    "percent": "%",
    "periodIsDateSeparator": true,
    "plusSign": "+",
    "secondPost": "",
    "shortDateFormatSuffix": ".",
    "yearPost": "",
    "textInputCurrencySymbol": "€"
};</script>
<script>const visualizationData = {};
visualizationData['1087974296'] = null;

function initVisualizations() {
    visualizationData['1087974296'] = {
        'elementId': 'embed_1087974296',
        'data': '\x5b\x5b\x22Other party\x22,null,\x22Initial Contact\x22,\x22End of contact\x22,null,\x22End of contact\x22,\x22foreground-color\x22,null\x5d,\x5b\x22POI 2\x22,null,\x2245580.0\x22,\x2245824.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 3\x22,null,\x2245580.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 4\x22,null,\x2245692.0\x22,\x2245733.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 5\x22,null,\x2245695.0\x22,\x2245761.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 26\x22,null,\x2245722.0\x22,\x2245727.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 31\x22,null,\x2245731.0\x22,\x2245776.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 33\x22,null,\x2245742.0\x22,\x2245771.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 34\x22,null,\x2245777.0\x22,\x2245790.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 36\x22,null,\x2245790.0\x22,\x2245847.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 37\x22,null,\x2245790.0\x22,\x2245793.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 38\x22,null,\x2245791.0\x22,\x2245817.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 39\x22,null,\x2245792.0\x22,\x2245797.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 42\x22,null,\x2245797.0\x22,\x2245805.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 307\x22,null,\x2245799.0\x22,\x2245800.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 781\x22,null,\x2245802.0\x22,\x2245804.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 782\x22,null,\x2245803.0\x22,\x2245804.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 967\x22,null,\x2245807.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 968\x22,null,\x2245809.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 969\x22,null,\x2245811.0\x22,\x2245965.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 1043\x22,null,\x2245813.0\x22,\x2245818.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1044\x22,null,\x2245813.0\x22,\x2245860.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1045\x22,null,\x2245826.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 1415\x22,null,\x2245838.0\x22,\x2245845.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1416\x22,null,\x2245839.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 1417\x22,null,\x2245839.0\x22,\x2245881.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1418\x22,null,\x2245839.0\x22,\x2245868.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1420\x22,null,\x2245854.0\x22,\x2245862.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1781\x22,null,\x2245855.0\x22,\x2245979.0\x22,null,-4794456,-16777216,null\x5d,\x5b\x22POI 1782\x22,null,\x2245855.0\x22,\x2245867.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1824\x22,null,\x2245861.0\x22,\x2245874.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1825\x22,null,\x2245867.0\x22,\x2245968.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1827\x22,null,\x2245869.0\x22,\x2245881.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1828\x22,null,\x2245870.0\x22,\x2245875.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1830\x22,null,\x2245880.0\x22,\x2245945.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1831\x22,null,\x2245894.0\x22,\x2245960.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1832\x22,null,\x2245894.0\x22,\x2245930.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1833\x22,null,\x2245933.0\x22,\x2245944.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1834\x22,null,\x2245935.0\x22,\x2245940.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1838\x22,null,\x2245945.0\x22,\x2245950.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1839\x22,null,\x2245946.0\x22,\x2245947.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1840\x22,null,\x2245954.0\x22,\x2245958.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1841\x22,null,\x2245954.0\x22,\x2245958.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1842\x22,null,\x2245958.0\x22,\x2245964.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1843\x22,null,\x2245965.0\x22,\x2245967.0\x22,null,-6759,-16777216,null\x5d,\x5b\x22POI 1844\x22,null,\x2245965.0\x22,\x2245967.0\x22,null,-6759,-16777216,null\x5d\x5d',
        'properties': '\x5b1,\x221641222559\x22,null,\x5b0,1,12,null,null,4,12\x5d,\x221957602821\x22\x5d',
    };
    drawVisualization(visualizationData['1087974296'], 'de_DE', 'Atlantic\/Reykjavik', false);
}

function drawVisualization(data, locale, timezone, isRtlShell) {
    const visualizationElement = document.getElementById(data.elementId);
    const sheetsViewportElement = document.getElementById('sheets-viewport');
    const width = sheetsViewportElement ? sheetsViewportElement.offsetWidth : window.innerWidth;
    const height = sheetsViewportElement ? sheetsViewportElement.offsetHeight : window.innerHeight;
    data.component = new waffle.visualization.timeline.renderer.export.TimelineExportComponent(data.data, data.properties, locale, timezone, width, height, isRtlShell);
    data.component.render(visualizationElement);
}

function onVisualizationExportApiLoad() {
    initVisualizations();
}</script>
<script>var VISUALIZATION_EXPORT_URI = [];
VISUALIZATION_EXPORT_URI.push('resources\/3564708238-VisualizationExportJ2cl_module.js');
if (window.addEventListener) {
    window.addEventListener('load',
        function () {
            window.visualizationScriptLoader.load();
        });
}
</script>

<script>
    async function setupOverlay() {
        const ogCanvasS = document.getElementsByClassName("timeline-canvas");

        if (!ogCanvasS.length) {
            await new Promise(res => setTimeout(res, 100));
            return setupOverlay();
        }
        await new Promise(res => setTimeout(res, 100));

        const baseCanvas = ogCanvasS[0];
        const overlay = document.getElementById("overlay-canvas");
        const ctxOverlay = overlay.getContext("2d");

        const scrollY = document.querySelector(".native-scrollbar-y");
        const scrollX = document.querySelector(".native-scrollbar-x");

        // Virtual view offsets
        let viewX = 0;
        let viewY = 0;

        let lines = [
            // Example line at fixed virtual coordinates
            {x: 930, color: "red", width: 3, text: "POI 2 fully declines"},
            {x: 1560, color: "red", width: 3, text: "POI 969 fully declines"},
        ];

        function redrawOverlay() {
            overlay.width = baseCanvas.width;
            overlay.height = baseCanvas.height;

            ctxOverlay.clearRect(0, 0, overlay.width, overlay.height);

            for (const line of lines) {
                ctxOverlay.strokeStyle = line.color;
                ctxOverlay.lineWidth = line.width;
                ctxOverlay.beginPath();

                // Convert virtual space → visible region
                const convX = line.x / 1873 * baseCanvas.width;

                ctxOverlay.moveTo(convX - viewX, 55);
                ctxOverlay.lineTo(convX - viewX, baseCanvas.height);
                ctxOverlay.font = "25px Roboto red";
                ctxOverlay.fillStyle = "red";
                ctxOverlay.fillText(line.text, convX - viewX, 25);

                ctxOverlay.stroke();
            }
        }

        function syncOverlayPosition() {
            const rect = baseCanvas.getBoundingClientRect();

            overlay.style.left = rect.left + "px";
            overlay.style.top = rect.top + "px";
            overlay.width = rect.width;
            overlay.height = rect.height;

            redrawOverlay();
        }

        scrollY.addEventListener("scroll", () => {
            viewY = scrollY.scrollTop;
            redrawOverlay();
        });

        scrollX.addEventListener("scroll", () => {
            viewX = scrollX.scrollLeft;
            redrawOverlay();
        });

        syncOverlayPosition();
        window.addEventListener("resize", syncOverlayPosition);
    }

    setupOverlay();
</script>
